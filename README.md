# AcFun-Live  
[![Actions Release](https://github.com/shaww855/acfun-live/actions/workflows/git-actions-release.yml/badge.svg)](https://github.com/shaww855/acfun-live/actions/workflows/git-actions-release.yml)
[![CodeQL](https://github.com/shaww855/acfun-live/actions/workflows/codeql-analysis.yml/badge.svg)](https://github.com/shaww855/acfun-live/actions/workflows/codeql-analysis.yml)  
[![version](https://img.shields.io/github/package-json/v/shaww855/acfun-live)](https://github.com/shaww855/acfun-live/tags)
[![downloads](https://img.shields.io/github/downloads/shaww855/acfun-live/total)](https://github.com/shaww855/acfun-live/releases)
[![license](https://img.shields.io/github/license/shaww855/acfun-live)](https://github.com/shaww855/acfun-live/blob/main/LICENSE)  
ä½¿ç”¨ Puppeteer å¼€å¯ AcFun ç›´æ’­ç›‘æ§å®¤ï¼ŒæŒ‚ç‰Œå­ï¼Œè¿˜æœ‰å¼€æ’­é€šçŸ¥ï¼ğŸ˜  
è¯·è®¤å‡†å”¯äºŒæŒ‡å®šä¸‹è½½ä»“åº“ Giteeã€Githubã€‚  
æœ¬å·¥å…·å®Œå…¨å…è´¹ã€å¼€æºï¼Œæœ‰æ›´å¥½çš„ç‚¹å­æ¬¢è¿PRã€‚
## éšç§æç¤º 
æœ¬å·¥å…·ä¸ä¼šå‘Aç«™ä»¥å¤–çš„ä»»ä½•æœåŠ¡å™¨å‘é€æˆ–å‚¨å­˜ä½ çš„ä»»ä½•ä¿¡æ¯ï¼Œä¹Ÿä¸ä¼šåˆ†äº«ä»»ä½•ä¿¡æ¯ç»™ä»»æ„ç¬¬ä¸‰æ–¹ï¼Œæ‰€æœ‰æ“ä½œå‡é€šè¿‡Aç«™Apiå®ç°ã€‚  
 - Win ç”¨æˆ·æ‰«ç ç™»å½•ä¸å‚¨å­˜ä»»ä½•ä¿¡æ¯ï¼›è´¦å·å¯†ç ç™»å½•åˆ™å‚¨å­˜äºè¿è¡Œç¯å¢ƒä¸­ï¼Œå…³é—­å³é”€æ¯ã€‚  
 - Linux ç”¨æˆ·è´¦å·å¯†ç æ˜æ–‡å­˜å‚¨äºæœ¬åœ°ï¼Œè¯·è‡ªè¡Œä¿è¯æœ¬åœ°ç¯å¢ƒå®‰å…¨ã€‚  

æœ¬å·¥å…·ä»…é™äºå¦‚ä¸‹æ“ä½œï¼š
  1. æ ¹æ®ä½ æä¾›çš„ä¿¡æ¯è¿›è¡Œç™»å½•æ“ä½œï¼›  
  1. æŸ¥è¯¢ä½ çš„ç²‰ä¸ç‰Œåˆ—è¡¨åŠç²‰ä¸ç‰Œç»éªŒï¼›  
  1. ä½¿ç”¨ä½ çš„è´¦å·ä¿¡æ¯æŸ¥è¯¢ä¸»æ’­å¼€æ’­ä¿¡æ¯ï¼›  
  1. ä½¿ç”¨ä½ çš„è´¦å·è¿›å…¥ç›´æ’­é—´ã€‚  
## è¿è¡Œç¯å¢ƒ  
æœ¬å·¥å…·é€šè¿‡æ“æ§ Chromium å®ç°å„ç§æ“ä½œï¼Œè¯·å§‹ç»ˆä¿æŒä½ çš„æµè§ˆå™¨ä¸ºæœ€æ–°ç‰ˆæœ¬ã€‚  
- ## Windows  
  **å¯é€‰æ‰«ç ç™»å½•ï¼Œæ— éœ€è¾“å…¥è´¦å·å¯†ç **  
  æ”¯æŒ Windows10 åŠä»¥ä¸Šï¼Œè¯·å‰å¾€ å‘å¸ƒé¡µé¢ ä¸‹è½½ï¼š   
  - [å›½å†…ä¸‹è½½åœ°å€](https://gitee.com/cn_shaw/acfun-live/releases)  
  - [æµ·å¤–ä¸‹è½½åœ°å€](https://github.com/shaww855/acfun-live/releases)  
- ## Linux  
  - å®‰è£…  
      - NodeJs å’Œ NPM ï¼ˆå°½é‡ä¿æŒä¸ºæœ€æ–°ç‰ˆï¼‰
      - ä¸‹è½½æºç   
      - å®‰è£…ä¾èµ–åŒ…ï¼ˆå»ºè®® `npm ci`ï¼‰  
      - æŒ‰ç…§ [é…ç½®æ–‡ä»¶è¯´æ˜](#é…ç½®æ–‡ä»¶è¯´æ˜) åˆ›å»ºåä¸º config.json çš„é…ç½®æ–‡ä»¶
  - è¿è¡Œ  
    `npm run start` æˆ– `node entry.js`  
  - è¿›é˜¶  
    ä½¿ç”¨è¿›ç¨‹å®ˆæŠ¤æŒ‚è½½  
    **å¦‚æœä½ åœ¨è¿›ç¨‹å®ˆæŠ¤ä¸­é…ç½®äº†é‡å¯ï¼Œè¯·å…³é—­ config.autoRestart é€‰é¡¹**   
    ä¾‹å¦‚ [PM2](https://pm2.keymetrics.io/) ï¼Œé…ç½®æ–‡ä»¶åœ¨ ecosystem.config.js ï¼Œç”¨å®ƒä¹Ÿå¯ä»¥è®°å½•æ—¥å¿—ã€‚


## å®˜æ–¹å¯¹ç¬¬ä¸‰æ–¹æ’ä»¶çš„æ€åº¦  
- 2022-05-17 æ— å¸¸çŒ´ [ac34895639](https://www.acfun.cn/a/ac34895639) [ac34899002](https://www.acfun.cn/a/ac34899002  
)
  >- <b>åŠæ—¶ä¿®æ”¹å¯†ç ï¼Œå®šæœŸæ›´æ–°å¯†ç ï¼Œå¢åŠ å¯†ç å¤æ‚ç¨‹åº¦ã€‚</b>å°¤å…¶æ˜¯è´¦å·æ³¨å†Œæ—¶é—´è¾ƒé•¿ã€å¯†ç è¾ƒé•¿æ—¶é—´æœªæ›´æ”¹ã€å¤šå¹³å°ä½¿ç”¨åŒä¸€å¯†ç çš„ç”¨æˆ·ã€‚    
  >- ä¸ä½¿ç”¨æ¥å†ä¸æ˜çš„ç¬¬ä¸‰æ–¹ç¨‹åºï¼Œè°¨æ…ç‚¹å‡»ä¸æ˜é“¾æ¥ï¼Œä¿æŠ¤è´¦å·å®‰å…¨ã€‚
- 2021-02-05 æ— å¸¸çŒ´ [ac23978179](https://www.acfun.cn/a/ac23978179)  
  >æˆ‘ä»¬æ³¨æ„åˆ°æœ€è¿‘æœ‰å¾ˆå¤šæœ‰å…³Aç«™å¹³å°çš„è‡ªåˆ¶æ’ä»¶å‡ºç°åœ¨ç¤¾åŒºä¸­ï¼Œ<b>æˆ‘ä»¬ä¸é¼“åŠ±ä¹Ÿä¸ç¦æ­¢å¤§å®¶è‡ªè¡Œå¼€å‘æ¶‰ACçš„ç›¸å…³æ’ä»¶</b>ï¼Œä½†è¯·è‚¥è‚¥ä»¬ä¸€å®šæ³¨æ„è´¦å·è´¢äº§å®‰å…¨ï¼Œå¯¹æ‰€æœ‰éœ€è¦Aç«™è´¦å·å¯†ç çš„æ’ä»¶æœ‰æ‰€è­¦æƒ•ï¼Œåœ¨Aç«™åªæœ‰å¹³å°ç™»å½•ä¸APPç™»å½•æ‰å¯ä»¥æä¾›è´¦å·å¯†ç å“¦ã€‚  
- 2021-06-08 æ´»åŠ¨çŒ´ [ac29442323](https://www.acfun.cn/a/ac29442323)  
  > ç”¨æˆ·ä¸å¾—ä»¥ä»»ä½•ä¸æ­£å½“æ‰‹æ®µåŠå…¶ä»–ç ´åæ´»åŠ¨è§„åˆ™ã€è¿èƒŒæ´»åŠ¨å…¬å¹³åŸåˆ™çš„æ–¹å¼å‚ä¸æœ¬æ´»åŠ¨ã€‚ä¸€ç»å‘ç°ï¼Œæœ¬å¹³å°æœ‰æƒæ’¤æ¶ˆæ´»åŠ¨èµ„æ ¼ï¼Œäº¦æœ‰æƒæ”¶å›ç”¨æˆ·å·²é¢†å–çš„ç°é‡‘å¥–åŠ±ã€å®ç‰©å¥–å“æˆ–è€…è™šæ‹Ÿå¥–å“ï¼Œå¹¶ä¿ç•™è¿½ç©¶è¯¥ç”¨æˆ·è´£ä»»çš„æƒåˆ©ã€‚å¦‚å› å‰è¿°ä¸æ­£å½“æ‰‹æ®µè¢«æœ¬å¹³å°è¿½ç©¶è´£ä»»é€ æˆçš„æŸå¤±ï¼Œæœ¬å¹³å°ä¸è¿›è¡Œä»»ä½•èµ”å¿æˆ–è¡¥å¿ã€‚ä¸æ­£å½“æ‰‹æ®µåŠèˆå¼Šè¡Œä¸ºåŒ…æ‹¬ä½†ä¸é™äºï¼šä¸‹è½½éå®˜æ–¹å®¢æˆ·ç«¯ï¼›ä½¿ç”¨æ¨¡æ‹Ÿå™¨ã€æ’ä»¶ã€å¤–æŒ‚ç­‰éæ³•å·¥å…·æ‰«ç ã€ä¸‹è½½ã€å®‰è£…ã€æ³¨å†Œã€ç™»å½•ã€èµ ä¸ã€é¢†å–å¥–åŠ±ï¼›æ¶æ„è´­ä¹°ï¼›è™šå‡åˆ†äº«ï¼›å€’ä¹°å€’å–ï¼›æ³¨å†Œå¤šä¸ªè´¦å·ï¼›ç¯¡æ”¹è®¾å¤‡æ•°æ®ï¼›æ¶æ„ç‰Ÿåˆ©ç­‰æ‰°ä¹±å¹³å°ç§©åºï¼›<b>ä½¿ç”¨æ’ä»¶ã€å¤–æŒ‚ã€ç³»ç»Ÿæˆ–ç¬¬ä¸‰æ–¹å·¥å…·</b>å¯¹æœ¬å¹³å°åŠæœ¬æ¬¡æ´»åŠ¨è¿›è¡Œå¹²æ‰°ã€ç ´åã€ä¿®æ”¹æˆ–æ–½åŠ å…¶ä»–å½±å“åŠæœ¬å¹³å°è®¤ä¸ºçš„å…¶ä»–ä¸æ­£å½“æ‰‹æ®µ
  
## é…ç½®æ–‡ä»¶è¯´æ˜
  
é”®å | ç±»å‹ | è¯´æ˜  
  --- | --- | ---  
account | String | è´¦å·  
password | String | å¯†ç   
debug | Boolean | æ˜¯å¦å¼€å¯è°ƒè¯•ï¼Œé»˜è®¤ä¸å¼€å¯<br>æ˜¯åˆ™ä¼šåœ¨å‰å°å±•ç¤ºæµè§ˆå™¨<br>å¦åˆ™é™é»˜è¿è¡Œ
autoRestart | Boolean<br>String | æ˜¯å¦å¼€å¯ç‚¹è‡ªåŠ¨é‡å¯<br>true ä¸ºæ¯å¤©0ç‚¹<br>æ–‡æœ¬éœ€ç¬¦åˆ cron [è§„åˆ™](https://github.com/node-schedule/node-schedule#cron-style-scheduling)çš„æ–‡æœ¬
checkLiveTimeout | Number | æ¯ï¼ˆåˆ†é’Ÿï¼‰æ£€æŸ¥ç›´æ’­  
likeBtnTimeout | Number | æ¯ï¼ˆåˆ†é’Ÿï¼‰è‡ªåŠ¨ç‚¹èµ <br> 0ä¸ºå…³é—­è‡ªåŠ¨ç‚¹èµ
defaultTimeout | Number | å¼‚æ­¥æ“ä½œæœ€å¤šç­‰å¾…ï¼ˆåˆ†é’Ÿï¼‰
executablePath | String | Chromium è·¯å¾„ <br> ä¾‹ `C:/Program Files (x86)/Google/Chrome/Application/chrome.exe` <br> æ³¨æ„è·¯å¾„çš„æ–œæ æ–¹å‘
uidUnwatchList | Array | è¿™äº› UID çš„ç›´æ’­é—´ä¸çœ‹
showLiveInfo | Boolean | æ£€æŸ¥ç›´æ’­çŠ¶æ€æ—¶æ˜¯å¦å±•ç¤ºä¸»æ’­è¯¦ç»†ä¿¡æ¯
checkWearMedal | Boolean | ä½©æˆ´ç‰Œå­çš„ä¸»æ’­ä¸è§‚çœ‹ <br> ï¼ˆæˆ´ç€ç‰Œå­è¯´æ˜ä½ æ­£åœ¨D TAï¼Œä¸éœ€è¦æœåŠ¡å™¨æŒ‚ç‰Œå­ï¼‰
serverRoomLimit | Array | æ”¯æŒå¤šå°æœåŠ¡å™¨ <br> å‡å¦‚ä½ æœ‰ä¸‰å°æœåŠ¡å™¨ï¼Œå¹¶å¡«å…¥äº† [3, 2, 0]  <br>  ç¬¬ä¸€å°æœåŠ¡å™¨è´Ÿè´£æŒ‚ç¬¬0ã€1ã€2ä¸ªç›´æ’­é—´ <br> ç¬¬äºŒå°æœåŠ¡å™¨æŒ‚ç¬¬3ã€4ä¸ªç›´æ’­é—´  <br>  ç¬¬ä¸‰å°æœåŠ¡å™¨æŒ‚å‰©ä½™çš„æ‰€æœ‰ç›´æ’­   <br>  ç›´æ’­é—´æŒ‰å¼€æ’­æ—¶é—´ä»æ—©åˆ°æ™šæ’åº <br> è¯·å…ˆæµ‹è¯•ä½ çš„æœºå­èƒ½æŒ‚å¤šå°‘ç›´æ’­é—´<br>ï¼ˆä¼°è®¡1Gå†…å­˜å¯ä»¥æŒ‚2ä¸ªç›´æ’­é—´ï¼‰ 
serverIndex | Array | å½“å‰æ˜¯ç¬¬å‡ å°ï¼Œä»0å¼€å§‹
checkAllRoom | Boolean | åªè¦æœ‰ç‰Œå­ï¼Œä¸ç®¡æ˜¯å¦å…³æ³¨éƒ½ç›‘æ§
useObsDanmaku | Boolean | ä½¿ç”¨å®˜æ–¹OBSå¼¹å¹•å·¥å…·ç›‘æ§<br>å¼€å¯æ­¤é¡¹æ—¶ è‡ªåŠ¨ç‚¹èµåŠŸèƒ½ ä¼šå¤±æ•ˆ
notification | Boolean<br>Array  | å€ŸåŠ©ç¬¬ä¸‰æ–¹APPæ¨é€å¼€æ’­é€šçŸ¥<br>true: æ‰€æœ‰ç²‰ä¸ç‰Œä¸»æ’­çš„é€šçŸ¥<br>false: ä¸æ¨é€å¼€æ’­é€šçŸ¥<br> [ Number ]: æŒ‡å®šuidå¼€æ’­æ¨é€ï¼Œå‰ææ˜¯å·²å…³æ³¨å¹¶æœ‰ç²‰ä¸ç‰Œ<br>æ­¤é…ç½®é¡¹ä¼šå— `checkAllRoom` å½±å“<br>æœåŠ¡å™¨æ—¶é—´çš„ 0~6 ç‚¹ä¸æ¨é€
iftttKey | String | [IFTTT](https://ifttt.com/) å¯†é’¥<br>[é…ç½®æ–¹æ³•](#IFTTT)
barkKey | String | [Bark](https://github.com/Finb/Bark) å¯†é’¥  ä»…é™IOS<br>[é…ç½®æ–¹æ³•](#BARK)
cookies | String<br>Array | ä¿å­˜ç™»å½•çŠ¶æ€çš„å­—æ®µ<br>è¦ä¹ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¦ä¹ˆä¸º`puppeteer`å¯¼å‡ºçš„`cookies`æ•°ç»„
version | String | å½“å‰ç‰ˆæœ¬å·<br>æœ¬å·¥å…·ä¼šå°†å®ƒä¸Githubä¸Šçš„ç‰ˆæœ¬å·å¯¹æ¯”å¹¶æç¤ºæ˜¯å¦æœ‰æ›´æ–°

## æ¨é€é…ç½®
### IFTTT

- åˆ›å»ºApplets  
  1. My Applets - Create
  2. If This - Add
      - æœç´¢ webhooks å¹¶è¿›å…¥é…ç½®
      - Event Name è¾“å…¥ acfun_live
  3. Then That - Add
      - æœç´¢é€‰æ‹© Notifications
      - é€‰æ‹© Send a rich notification from the IFTTT app
      - Title é€‰æ‹©å˜é‡ Value1
      - Message é€‰æ‹©å˜é‡ Value2
      - Link URL é€‰æ‹©å˜é‡ Value3
      - Create action
  4. Continue
  5. Finish
- è·å– Webhooks Key
    1. æ‰“å¼€ https://ifttt.com/maker_webhooks
    2. ç‚¹å‡» Documentation
    3. æ­¤é¡µé¢ä¼šæ˜¾ç¤ºä½ çš„ key  
      ï¼ˆå¯ä»¥åœ¨è¿™ä¸ªé¡µé¢æµ‹è¯•ä½ çš„ Webhook  ï¼‰

### BARK 

1. App Store æœç´¢å¹¶ä¸‹è½½å®‰è£…  
2. æ‰“å¼€ app å°±å¯ä»¥çœ‹åˆ°é“¾æ¥  https://api.day.app/ä½ çš„key/

## å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ³•
  * Q   
  ERROR: Failed to set up Chromium r782078! Set  "PUPPETEER_SKIP_DOWNLOAD" env variable to skip download.  
  * A   
  ä¸€èˆ¬æ˜¯ç½‘ç»œæ…¢å¯¼è‡´ä¸‹è½½æµè§ˆå™¨å¤±è´¥ï¼Œè§£å†³æ–¹æ³•æœ‰äºŒ  
     -  è®¾ç½®æ·˜å®æºåå†æ¬¡å°è¯•å®‰è£…    
     `npm config set puppeteer_download_host=https://npm.taobao.org/mirrors`  
     -  å¦‚æœä½ æœ¬æœºå·²ç»å®‰è£… Chromiumï¼Œå¯ä»¥è®¾ç½®è·³è¿‡ä¸‹è½½åï¼Œå†æ¬¡å°è¯•å®‰è£…  
     `npm config set puppeteer_skip_chromium_download=true`  
     è¿è¡Œå‰éœ€è¦åœ¨ config.json é‡Œå¡«å…¥ executablePath 
  --- 
  * Q  
    npmé»˜è®¤ä¸ä»¥rootèº«ä»½è¿è¡Œ  
  * A  
    `npm install puppeteer --unsafe-perm=true --allow-root`  
    https://github.com/puppeteer/puppeteer/issues/1597
  ---
  * Q  
  (node:10916) UnhandledPromiseRejectionWarning: Error: Failed to launch the browser process!
  path/node_modules/puppeteer/.local-chromium/linux-782078/chrome-linux/chrome: error while loading shared libraries: libXss.so.1: cannot open shared object file: No such file or directory
  * A  
  æŸ¥æ‰¾ç¼ºå°‘çš„ä¾èµ–å¹¶å®‰è£…  
  https://github.com/puppeteer/puppeteer/blob/main/docs/troubleshooting.md
  ---
  * Q  
  æ‰“åŒ…æ‡’äººåŒ…æ—¶è¿›åº¦æ…¢  
  * A  
  å¯èƒ½æ˜¯éœ€è¦ä¸‹è½½nodeåŒ…ç¼“æ…¢å¯¼è‡´çš„  
    1. å» https://github.com/vercel/pkg-fetch/releases ä¸‹è½½æç¤ºä¸­çš„ `node` ç‰ˆæœ¬åŒ…  
    2. æ”¾åˆ° `C:\Users\{ç”¨æˆ·å}\.pkg-cache\{å½“å‰pkgç‰ˆæœ¬å·}` ç›®å½•ä¸‹  
    3. æ”¹åä¸º `fetched-{nodeç‰ˆæœ¬å·}-win-x64`  
    4. å†æ¬¡è¿è¡Œæ‰“åŒ…å‘½ä»¤å³å¯
  ---
  * Q  
  å…¶ä»–é—®é¢˜è¯·å‚ç…§ `Puppeteer` å®˜æ–¹è§£å†³æ–¹æ¡ˆ  
  * A  
  https://github.com/puppeteer/puppeteer/blob/main/docs/troubleshooting.md


## Stargazers over time

[![Stargazers over time](https://starchart.cc/shaww855/acfun-live.svg)](https://starchart.cc/shaww855/acfun-live)
